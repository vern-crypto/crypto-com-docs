"use strict";(self.webpackChunkcrypto_com_docs=self.webpackChunkcrypto_com_docs||[]).push([[1484],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>u});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var c=n.createContext({}),l=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},p=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=l(a),m=i,u=d["".concat(c,".").concat(m)]||d[m]||h[m]||o;return a?n.createElement(u,r(r({ref:t},p),{},{components:a})):n.createElement(u,r({ref:t},p))}));function u(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=a.length,r=new Array(o);r[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[d]="string"==typeof e?e:i,r[1]=s;for(var l=2;l<o;l++)r[l]=a[l];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},3537:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var n=a(7462),i=(a(7294),a(3905));const o={title:"Chrome Extension Wallet Integration",sidebar_position:40},r="Introduction",s={unversionedId:"defi-wallet/mobile-integration",id:"defi-wallet/mobile-integration",title:"Chrome Extension Wallet Integration",description:"Compared with a normal web browser application on a phone, the built-in DApp browser in the Crypto.com DeFi Wallet app provides more powerful functionalities and a smooth UX experience for users:",source:"@site/docs/defi-wallet/mobile-integration.md",sourceDirName:"defi-wallet",slug:"/defi-wallet/mobile-integration",permalink:"/crypto-com-docs/docs/defi-wallet/mobile-integration",draft:!1,editUrl:"https://github.com/vern-crypto/crypto-com-docs/tree/main/docs/defi-wallet/mobile-integration.md",tags:[],version:"current",sidebarPosition:40,frontMatter:{title:"Chrome Extension Wallet Integration",sidebar_position:40},sidebar:"defiWalletSidebar",previous:{title:"Chrome Extension Wallet Integration (Aptos)",permalink:"/crypto-com-docs/docs/defi-wallet/aptos-integration"}},c={},l=[{value:"Ethereum.Provider",id:"ethereumprovider",level:2},{value:"Methods supported",id:"methods-supported",level:3},{value:"Best practice",id:"best-practice",level:3},{value:"WalletConnect",id:"walletconnect",level:2},{value:"Methods supported",id:"methods-supported-1",level:3}],p={toc:l};function d(e){let{components:t,...a}=e;return(0,i.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"Compared with a normal web browser application on a phone, the built-in DApp browser in the Crypto.com DeFi Wallet app provides more powerful functionalities and a smooth UX experience for users: "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Within the DApp browser, a user can interact with a DApp through multiple approaches, JS Bridge, WalletConnect."),(0,i.kt)("li",{parentName:"ol"},"A fast and stable connection with DApp can bring a one-step-to-transact experience, which helps users to get rid of scanning QRcode or interactions across applications or even across platforms."),(0,i.kt)("li",{parentName:"ol"},"A easy way to manage digital assets in the Crypto.com DeFi Wallet app, buy crypto, gain more earnings in DeFi Earn Protocols, and discover more high-investment-value NFT. ")),(0,i.kt)("h1",{id:"wallet-connections"},"Wallet Connections"),(0,i.kt)("p",null,"Currently, the DApp browser in Crypto.com DeFi Wallet app supports two kinds of connections with DApp:"),(0,i.kt)("h2",{id:"ethereumprovider"},"Ethereum.Provider"),(0,i.kt)("p",null,"The Ethereum.Provider interface provides a functional interface and a more stable technical solution(i.e. JS bridge) for DApps to interact with. All the actions and the corresponding callbacks would be transformed as JS calls between DApp and the DApp browser. "),(0,i.kt)("h3",{id:"methods-supported"},"Methods supported"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"requestAccounts")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{"id":1634697171550,"name":"requestAccounts"}\n')),(0,i.kt)("p",null,"To ask the user to grant permission to use his wallet address of a specific chain.\n2. addEthereumChain"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{"id":1634697171550,"name":"addEthereumChain","object":{"chainId":"0x152","chainName":"Cronos Mainnet","nativeCurrency":{"name":"VVS","symbol":"vvs","decimals":18},"rpcUrls":["https:\\/\\/cronos-testnet-3.crypto.org:8545"],"blockExplorerUrls":["https:\\/\\/cronos.crypto.org\\/explorer\\/\\/"]}}\n')),(0,i.kt)("p",null,"To ask the user to switch to a specific EVM-like chain. This action would be automatically finished by the DApp browser without bothering the user, if this EVM-like chain is supported in the DApp Browser.\n3. switchEthereumChain"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{"id":1653028273548,"name":"switchEthereumChain","object":{"chainId":25}}\n')),(0,i.kt)("p",null,"Similar to the ",(0,i.kt)("inlineCode",{parentName:"p"},"addEthereumChain"),", to ask the user to switch to a specific EVM-like chain. This action would be automatically finished by the DApp browser without bothering the user, if this EVM-like chain is supported in the DApp Browser.\n4. signTypedMessage"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{"id":1633955435461,"name":"signTypedMessage","object":{"data":"0x77c8bfd9eba1b7cb3733f7a592c169a07d9f49f2bbe9f44b7555e62c8cd416ce","raw":"{\\"types\\":{\\"EIP712Domain\\":[{\\"name\\":\\"name\\",\\"type\\":\\"string\\"},{\\"name\\":\\"version\\",\\"type\\":\\"string\\"},{\\"name\\":\\"chainId\\",\\"type\\":\\"uint256\\"},{\\"name\\":\\"verifyingContract\\",\\"type\\":\\"address\\"}],\\"Permit\\":[{\\"name\\":\\"owner\\",\\"type\\":\\"address\\"},{\\"name\\":\\"spender\\",\\"type\\":\\"address\\"},{\\"name\\":\\"value\\",\\"type\\":\\"uint256\\"},{\\"name\\":\\"nonce\\",\\"type\\":\\"uint256\\"},{\\"name\\":\\"deadline\\",\\"type\\":\\"uint256\\"}]},\\"domain\\":{\\"name\\":\\"Pancake LPs\\",\\"version\\":\\"1\\",\\"chainId\\":56,\\"verifyingContract\\":\\"0x0eD7e52944161450477ee417DE9Cd3a859b14fD0\\"},\\"primaryType\\":\\"Permit\\",\\"message\\":{\\"owner\\":\\"0x81080a7e991bcDdDBA8C2302A70f45d6Bd369Ab5\\",\\"spender\\":\\"0x10ED43C718714eb63d5aA57B78B54704E256024E\\",\\"value\\":\\"31248219154274995\\",\\"nonce\\":\\"0x00\\",\\"deadline\\":1633956630}}"}}                 \n')),(0,i.kt)("p",null,"To ask the user to sign a typed message as approval to some actions. The type of the data to sign would be included in the ",(0,i.kt)("inlineCode",{parentName:"p"},"raw")," field of the ",(0,i.kt)("inlineCode",{parentName:"p"},"object")," struct. Calculates an Ethereum-specific signature in the form of\n",(0,i.kt)("inlineCode",{parentName:"p"},'sign(keccak256("\\x19Ethereum Signed Message:\\n" + len(message) + message)))'),".\nAdding a prefix to the message makes the calculated signature recognisable as an Ethereum specific signature and would prevent misuse where a malicious DApp can sign arbitrary data (e.g. transaction) and use the signature to impersonate the victim.\n5. signMessage"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{"id":1653028273548,"name":"signMessage","object":{"data":"0x77c8bfd9eba1b7cb3733f7a592c169a07d9f49f2bbe9f44b7555e62c8cd416ce"}}\n')),(0,i.kt)("p",null,"To ask the user to sign a message as approval to some actions. The data to sign would be included in the ",(0,i.kt)("inlineCode",{parentName:"p"},"data")," field of the ",(0,i.kt)("inlineCode",{parentName:"p"},"object")," struct.\nThe sign method calculates an Ethereum specific signature with: ",(0,i.kt)("inlineCode",{parentName:"p"},' sign(keccak256("\\x19Ethereum Signed Message:\\n" + len(message) + message)))'),".\n6. signPersonalMessage"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{"id":1653028273548,"name":"signPersonalMessage","object":{"data":"0x77c8bfd9eba1b7cb3733f7a592c169a07d9f49f2bbe9f44b7555e62c8cd416ce"}}\n')),(0,i.kt)("p",null,"Similar to ",(0,i.kt)("inlineCode",{parentName:"p"},"signMessage"),", to ask the user to sign a typed message as approval to some actions. The type of the data to sign would be included in the ",(0,i.kt)("inlineCode",{parentName:"p"},"raw")," field of the ",(0,i.kt)("inlineCode",{parentName:"p"},"object")," struct. The sign method calculates an Ethereum specific signature with: ",(0,i.kt)("inlineCode",{parentName:"p"},'sign(keccack256("\\x19Ethereum Signed Message:\\n" + len(message) + message)))'),".\n7. signTransaction"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{"id":1633951323851,"name":"signTransaction",  "object":{"gas":"0x21d29","gasPrice":"0x12a05f200","from":"0x81080a7e991bcdddba8c2302a70f45d6bd369ab5","to":"0x10ed43c718714eb63d5aa57b78b54704e256024e","data":"0x38ed1739000000000000000000000000000000000000000000000000016345785d8a00000000000000000000000000000000000000000000000000000012740d3ec560dd00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000081080a7e991bcdddba8c2302a70f45d6bd369ab500000000000000000000000000000000000000000000000000000000616422fe0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000e9e7cea3dedca5984780bafc599bd69add087d560000000000000000000000000e09fabb73bd3ade0a17ecc321fd13a19e81ce82"}}\n')),(0,i.kt)("p",null,"To ask the user to sign a transaction as approval to contruct the raw data of a transaction to broadcast later. The raw transaction information to sign would be included in the ",(0,i.kt)("inlineCode",{parentName:"p"},"object"),"."),(0,i.kt)("h3",{id:"best-practice"},"Best practice"),(0,i.kt)("p",null,"A DApp could take advantage of the methods above to provide an easy-to-use expeprience to users."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"When a DApp is loading and all JS scripts are loaded, it could ininitiatively call the ",(0,i.kt)("inlineCode",{parentName:"li"},"requestAccounts")," to immediately get an address from a user. "),(0,i.kt)("li",{parentName:"ol"},"When the chain id set to a DApp is unmatched with expectation or unsupported, it could ininitiatively call the 'switchEthereumChain' to tell the DApp browser which chain would be correct to interact with. ")),(0,i.kt)("h2",{id:"walletconnect"},"WalletConnect"),(0,i.kt)("p",null," ",(0,i.kt)("a",{parentName:"p",href:"https://docs.walletconnect.com/"},"WalletConnect")," is an open protocol to communicate securely between the DApp browser and Dapps (Web3 Apps), which establishes a remote connection (WebSocket). Currently, the DApp browser only supports WalletConnect V1.0. Since the connection is technically based on a WebSocket, it would be comparatively less stable than a JS bridge. But it could set up a connection remotely in cross-platforms or cross-devices scenarios. In WalletConnect, all the actions and the corresponding callbacks would be transformed as a typed message transferred via the underlying WebSockets. "),(0,i.kt)("h3",{id:"methods-supported-1"},"Methods supported"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"wc_sessionRequest \\\nThe first dispatched JSON RPC request is the connection request including the details of the requesting peers.  Related parameters](",(0,i.kt)("a",{parentName:"li",href:"https://docs.walletconnect.com/tech-spec#session-request"},"https://docs.walletconnect.com/tech-spec#session-request"),")"),(0,i.kt)("li",{parentName:"ol"},"wc_sessionUpdate \\\nThis JSON RPC request is dispatched by the Wallet when updating the session. This can occur either when the session is killed by the Wallet, when it provides new accounts or when it changes the active chain id. ",(0,i.kt)("a",{parentName:"li",href:"https://docs.walletconnect.com/tech-spec#session-update"},"Related parameters")),(0,i.kt)("li",{parentName:"ol"},"wallet_switchEthereumChain \\\nA RPC method for switching the wallet\u2019s active Ethereum chain(",(0,i.kt)("a",{parentName:"li",href:"https://eips.ethereum.org/EIPS/eip-3326"},"More information"),"). This method accepts a single object parameter, specified by the following TypeScript interface: \\\n",(0,i.kt)("inlineCode",{parentName:"li"},"interface SwitchEthereumChainParameter {\n  chainId: string;\n}"),"."),(0,i.kt)("li",{parentName:"ol"},'eth_sign \\\nThe sign method calculates an Ethereum specific signature with: sign(keccak256("\\x19Ethereum Signed Message:\\n" + len(message) + message))).',(0,i.kt)("a",{parentName:"li",href:"https://docs.walletconnect.com/json-rpc-api-methods/ethereum#eth_sign"},"More information")),(0,i.kt)("li",{parentName:"ol"},"personal_sign \\\nAdded a prefix to the data so it could not impersonate transactions. We also made this method able to display human readable text when UTF-8 encoded, making it a popular choice for site logins. \\\n",(0,i.kt)("inlineCode",{parentName:"li"},'{"method": "personal_sign", "params": [message, account, password]}')),(0,i.kt)("li",{parentName:"ol"},'eth_signTypedData \\\nCalculates an Ethereum-specific signature in the form of keccak256("\\x19Ethereum Signed Message:\\n" + len(message) + message)). ',(0,i.kt)("a",{parentName:"li",href:"https://docs.walletconnect.com/json-rpc-api-methods/ethereum#eth_signtypeddata"},"More information")),(0,i.kt)("li",{parentName:"ol"},"eth_signTypedData_v3 \\\nThe method signTypedData_v3 currently represents the latest version of the ",(0,i.kt)("a",{parentName:"li",href:"https://eips.ethereum.org/EIPS/eip-712"},"EIP-712 spec"),", making it the most secure method for signing cheap-to-verify data on-chain that we have yet."),(0,i.kt)("li",{parentName:"ol"},"eth_signTypedData_v4 \\\nThe method signTypedData_v4 currently represents the latest version of the ",(0,i.kt)("a",{parentName:"li",href:"https://eips.ethereum.org/EIPS/eip-712"},"EIP-712 spec"),", with added support for arrays and with a breaking fix for the way structs are encoded. ")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"for ",(0,i.kt)("inlineCode",{parentName:"li"},"eth_signTypedData_v3")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"eth_signTypedData_v4"),", you can also get more information from this ",(0,i.kt)("a",{parentName:"li",href:"https://medium.com/metamask/eip712-is-coming-what-to-expect-and-how-to-use-it-bb92fd1a7a26"},"article"))),(0,i.kt)("h1",{id:"network-switch"},"Network Switch"),(0,i.kt)("p",null,"For DApps that support transactions on multiple chains, the DApp browser also provides a quick way for users to switch chains. By simply tapping the chain icon on the right corner of the top bar to pop up a supported chains list, a user can switch to any chain item in the list. The chain information including the chain id and the RPC URL (if necessary) would update to the DApp accordingly."),(0,i.kt)("h1",{id:"wallet-switch"},"Wallet Switch"),(0,i.kt)("p",null,"If a user owns multiple wallets in the app, he can also quickly switch to the desired wallet by simply tapping the avatar icon on the right-most corner of the top bar."),(0,i.kt)("h1",{id:"reference"},"Reference"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_sign"},"Ethereum JSON RPC methods")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://docs.walletconnect.com/json-rpc-api-methods/ethereum"},"Wallet Connect JSON RPC methods"))))}d.isMDXComponent=!0}}]);